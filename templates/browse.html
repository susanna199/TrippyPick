{% extends "base.html" %}
{% block title %}Browse Packages | TrippyPick{% endblock %}

{% block content %}
<section id="browse-page">
  <div class="browse-container">
    <div class="filters">
      <h2>Filters</h2>
      <input class="search-input" type="text" placeholder="Search destination" />
      <select class="dropdown">
        <option>Any Duration</option>
        <option>1-3 Days</option>
        <option>4-6 Days</option>
        <option>7+ Days</option>
      </select>
      <select class="dropdown">
        <option>Any Theme</option>
        <option>Adventure</option>
        <option>Beach</option>
        <option>Culture</option>
      </select>
      <button class="apply-btn">Apply Filters</button>
    </div>
    <div class="package-grid">
      <div class="cards">
        {% for package in packages %}
        <div class="card">
            <div class="image-placeholder">
                {# FINAL WORKING VERSION: url_for() now works because app.py is fixed #}
                {% if package.destination_img %}
                    <img src="{{ url_for('static', filename=package.destination_img.replace('static/', '')) }}" alt=" ">
                {% else %}
                    üèîÔ∏è
                {% endif %}
            </div>

            <h3>{{ package.package_name }}</h3>
            <p><i class="fas fa-location-dot"></i> {{ package.destination }}</p>
            <div class="tags">
                {% set first_theme = (package.themes.split(',')[0] | replace("[", "") | replace("]", "") | replace("'", "")).strip() %}
                <span class="tag">{{ first_theme }}</span>
                <span class="tag">{{ package.days }}D/{{ package.nights }}N</span>
            </div>
            <div class="price">
                <span class="current">‚Çπ{{ "{:,.0f}".format(package.cost_per_package) }}</span>
            </div>
            <div class="buttons">
                <a href="{{ url_for('package_detail', package_id=package.package_id) }}" class="details-btn">View Details</a>
                <a href="{{ url_for('compare', ids=package.package_id) }}" class="compare-btn">Compare</a>
            </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
</section>
{% endblock %}